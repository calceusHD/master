#!/usr/bin/env python3
import numpy
import scipy.io as sio
import matplotlib.pyplot as plt
from scipy.linalg import lu, circulant
import sys
import math

res = """1.500000 44.000000 1301832 234175 1.798811E-01 2009 2001 9.960179E-01
1.531250 44.000000 1296648 227739 1.756367E-01 2001 2001 1.000000E+00
1.562500 44.000000 1296648 225012 1.735336E-01 2001 2001 1.000000E+00
1.593750 44.000000 1296648 217307 1.675914E-01 2001 2001 1.000000E+00
1.625000 44.000000 1296648 208833 1.610560E-01 2001 2001 1.000000E+00
1.656250 44.000000 1296648 199977 1.542261E-01 2001 2001 1.000000E+00
1.687500 44.000000 1296648 188693 1.455237E-01 2001 2001 1.000000E+00
1.718750 44.000000 1296648 177877 1.371822E-01 2001 2001 1.000000E+00
1.750000 44.000000 1296648 153570 1.184362E-01 2001 2001 1.000000E+00
1.781250 44.000000 1296648 103607 7.990372E-02 2001 2001 1.000000E+00
1.812500 44.000000 1296648 59314 4.574410E-02 2001 2001 1.000000E+00
1.843750 44.000000 1297944 22273 1.716022E-02 2003 2001 9.990015E-01
1.875000 44.000000 1332288 9077 6.813092E-03 2056 2001 9.732490E-01
1.906250 44.000000 1776168 4089 2.302147E-03 2741 2001 7.300255E-01
1.937500 44.000000 3286656 2732 8.312400E-04 5072 2001 3.945189E-01
1.968750 44.000000 14771160 2170 1.469079E-04 22795 2001 8.778241E-02
2.000000 44.000000 149554512 2052 1.372075E-05 230794 2001 8.670069E-03
2.031250 44.000000 3396869136 2014 5.928989E-07 5242082 2001 3.817186E-04
2.062500 44.000000 6480000000 40 6.172840E-09 10000000 40 4.000000E-06
2.093750 44.000000 6480000000 0 0.000000E+00 10000000 0 0.000000E+00
1.500000 48.000000 1303128 234809 1.801887E-01 2011 2001 9.950274E-01
1.531250 48.000000 1296648 229220 1.767789E-01 2001 2001 1.000000E+00
1.562500 48.000000 1296648 224162 1.728781E-01 2001 2001 1.000000E+00
1.593750 48.000000 1296648 217236 1.675366E-01 2001 2001 1.000000E+00
1.625000 48.000000 1296648 211153 1.628453E-01 2001 2001 1.000000E+00
1.656250 48.000000 1296648 201383 1.553105E-01 2001 2001 1.000000E+00
1.687500 48.000000 1296648 191130 1.474032E-01 2001 2001 1.000000E+00
1.718750 48.000000 1296648 178880 1.379557E-01 2001 2001 1.000000E+00
1.750000 48.000000 1296648 157023 1.210992E-01 2001 2001 1.000000E+00
1.781250 48.000000 1296648 116736 9.002906E-02 2001 2001 1.000000E+00
1.812500 48.000000 1296648 72062 5.557561E-02 2001 2001 1.000000E+00
1.843750 48.000000 1296648 27387 2.112138E-02 2001 2001 1.000000E+00
1.875000 48.000000 1309608 11659 8.902664E-03 2021 2001 9.901039E-01
1.906250 48.000000 1546776 4911 3.174991E-03 2387 2001 8.382908E-01
1.937500 48.000000 2740392 2892 1.055324E-03 4229 2001 4.731615E-01
1.968750 48.000000 9660384 2220 2.298045E-04 14908 2001 1.342232E-01
2.000000 48.000000 65831616 2056 3.123119E-05 101592 2001 1.969643E-02
2.031250 48.000000 3300669000 2011 6.092704E-07 5093625 2001 3.928440E-04
2.062500 48.000000 6480000000 40 6.172840E-09 10000000 39 3.900000E-06
2.093750 48.000000 6480000000 0 0.000000E+00 10000000 0 0.000000E+00
1.500000 52.000000 1545480 228445 1.478149E-01 2385 2001 8.389937E-01
1.531250 52.000000 1296648 224100 1.728303E-01 2001 2001 1.000000E+00
1.562500 52.000000 1296648 224109 1.728372E-01 2001 2001 1.000000E+00
1.593750 52.000000 1296648 219702 1.694384E-01 2001 2001 1.000000E+00
1.625000 52.000000 1296648 213146 1.643823E-01 2001 2001 1.000000E+00
1.656250 52.000000 1296648 204400 1.576372E-01 2001 2001 1.000000E+00
1.687500 52.000000 1296648 193008 1.488515E-01 2001 2001 1.000000E+00
1.718750 52.000000 1296648 182775 1.409596E-01 2001 2001 1.000000E+00
1.750000 52.000000 1296648 164237 1.266627E-01 2001 2001 1.000000E+00
1.781250 52.000000 1296648 134481 1.037143E-01 2001 2001 1.000000E+00
1.812500 52.000000 1296648 92926 7.166633E-02 2001 2001 1.000000E+00
1.843750 52.000000 1296648 41135 3.172411E-02 2001 2001 1.000000E+00
1.875000 52.000000 1297296 16985 1.309262E-02 2002 2001 9.995005E-01
1.906250 52.000000 1411992 7251 5.135298E-03 2179 2001 9.183112E-01
1.937500 52.000000 2160432 3582 1.658002E-03 3334 2001 6.001800E-01
1.968750 52.000000 6668568 2416 3.622967E-04 10291 2001 1.944418E-01
2.000000 52.000000 30104136 2085 6.925959E-05 46457 2001 4.307209E-02
2.031250 52.000000 3323507760 2016 6.065880E-07 5128870 2001 3.901444E-04
2.062500 52.000000 6480000000 37 5.709877E-09 10000000 37 3.700000E-06
2.093750 52.000000 6480000000 0 0.000000E+00 10000000 0 0.000000E+00
1.500000 56.000000 1545480 179267 1.159944E-01 2385 2001 8.389937E-01
1.531250 56.000000 1297944 168616 1.299101E-01 2003 2001 9.990015E-01
1.562500 56.000000 1296648 191253 1.474980E-01 2001 2001 1.000000E+00
1.593750 56.000000 1297296 187440 1.444851E-01 2002 2001 9.995005E-01
1.625000 56.000000 1296648 171730 1.324415E-01 2001 2001 1.000000E+00
1.656250 56.000000 1296648 153044 1.180305E-01 2001 2001 1.000000E+00
1.687500 56.000000 1297944 124123 9.563047E-02 2003 2001 9.990015E-01
1.718750 56.000000 1296648 136928 1.056015E-01 2001 2001 1.000000E+00
1.750000 56.000000 1297944 115619 8.907858E-02 2003 2001 9.990015E-01
1.781250 56.000000 1301184 74370 5.715564E-02 2008 2001 9.965140E-01
1.812500 56.000000 1298592 69921 5.384370E-02 2004 2001 9.985030E-01
1.843750 56.000000 1296648 35720 2.754795E-02 2001 2001 1.000000E+00
1.875000 56.000000 1303776 15961 1.224213E-02 2012 2001 9.945328E-01
1.906250 56.000000 1391256 7513 5.400157E-03 2147 2001 9.319981E-01
1.937500 56.000000 1840968 3927 2.133117E-03 2841 2001 7.043295E-01
1.968750 56.000000 5261112 2506 4.763252E-04 8119 2001 2.464589E-01
2.000000 56.000000 19189224 2110 1.099575E-04 29613 2001 6.757168E-02
2.031250 56.000000 3089997720 2025 6.553403E-07 4768515 2001 4.196275E-04
2.062500 56.000000 6480000000 28 4.320988E-09 10000000 28 2.800000E-06
2.093750 56.000000 6480000000 0 0.000000E+00 10000000 0 0.000000E+00
1.500000 60.000000 2299104 4099 1.782868E-03 3548 2001 5.639797E-01
1.531250 60.000000 2083968 3869 1.856554E-03 3216 2001 6.222015E-01
1.562500 60.000000 1863000 4851 2.603865E-03 2875 2001 6.960000E-01
1.593750 60.000000 1885680 4398 2.332315E-03 2910 2001 6.876289E-01
1.625000 60.000000 1956960 4256 2.174802E-03 3020 2001 6.625828E-01
1.656250 60.000000 2048328 3804 1.857125E-03 3161 2001 6.330275E-01
1.687500 60.000000 2131920 3892 1.825584E-03 3290 2001 6.082067E-01
1.718750 60.000000 1944000 4115 2.116770E-03 3000 2001 6.670000E-01
1.750000 60.000000 1997136 3873 1.939277E-03 3082 2001 6.492537E-01
1.781250 60.000000 2212920 3672 1.659346E-03 3415 2001 5.859444E-01
1.812500 60.000000 2177928 3756 1.724575E-03 3361 2001 5.953586E-01
1.843750 60.000000 2372976 3390 1.428586E-03 3662 2001 5.464227E-01
1.875000 60.000000 2852496 3141 1.101141E-03 4402 2001 4.545661E-01
1.906250 60.000000 4214592 2714 6.439532E-04 6504 2001 3.076568E-01
1.937500 60.000000 6315408 2406 3.809730E-04 9746 2001 2.053150E-01
1.968750 60.000000 22166784 2115 9.541303E-05 34208 2001 5.849509E-02
2.000000 60.000000 183063240 2056 1.123109E-05 282505 2001 7.083061E-03
2.031250 60.000000 4028797440 2024 5.023832E-07 6217280 2001 3.218449E-04
2.062500 60.000000 6480000000 33 5.092593E-09 10000000 33 3.300000E-06
2.093750 60.000000 6480000000 0 0.000000E+00 10000000 0 0.000000E+00"""

ber = {}
fer = {}
columns = []
snr = []
ber_cols = {}

for line in res.splitlines():
    elems = line.split(" ")
    if not elems[0] in snr:
        snr.append(elems[0])
    if not elems[0] in ber:
        ber[elems[0]] = []
    if not elems[0] in fer:
        fer[elems[0]] = []
    if not elems[1] in columns:
        columns.append(elems[1])
        ber_cols[elems[1]] = []
    ber_cols[elems[1]].append(float(elems[4]))
    ber[elems[0]].append(elems[4])
    fer[elems[0]].append(elems[7])
snr = [float(x) for x in snr]
print("snr " + " ".join(columns))
for row in ber:
    print(row + " " + " ".join(ber[row]))
fig, ax = plt.subplots()
for i in ber_cols:
    plt.semilogy(snr, ber_cols[i], label=i)
legend = ax.legend(loc="lower left")
plt.show()
print("\n")
print("snr " + " ".join(columns))
for row in fer:
    print(row + " " + " ".join(fer[row]))

